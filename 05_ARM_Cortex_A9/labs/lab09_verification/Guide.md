# Lab 9: 系统验证

## 📋 实验概述

| 项目 | 内容 |
|------|------|
| **实验名称** | 功能验证与覆盖率分析 |
| **预计时长** | 10-12 小时 |
| **难度等级** | ⭐⭐⭐⭐⭐ |
| **前置实验** | Lab 8 |

## 🎯 实验目标

1. 编写综合测试程序
2. 实现自检测试平台
3. 覆盖率驱动验证
4. 边界条件测试

---

## 📚 理论背景

### 验证方法学

```
┌─────────────────────────────────────────────────────────────────┐
│                    Verification Environment                     │
│                                                                 │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐       │
│  │  Stimulus   │────▶│    DUT      │────▶│   Monitor   │       │
│  │  Generator  │     │ (ARM Core)  │     │             │       │
│  └─────────────┘     └─────────────┘     └──────┬──────┘       │
│        │                                         │              │
│        │                                         ▼              │
│        │                                  ┌─────────────┐       │
│        └─────────────────────────────────▶│  Scoreboard │       │
│                    预期结果                │  (Checker)  │       │
│                                           └─────────────┘       │
│                                                  │              │
│                                                  ▼              │
│                                           ┌─────────────┐       │
│                                           │  Coverage   │       │
│                                           │  Collector  │       │
│                                           └─────────────┘       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 功能覆盖点

1. **指令覆盖**
   - 所有数据处理指令
   - 所有条件码组合
   - Load/Store 各种寻址模式
   - 分支指令（条件/无条件）

2. **流水线覆盖**
   - 前递路径 (EX→EX, MEM→EX)
   - Load-Use 暂停
   - 分支冲刷
   - 连续依赖

3. **边界覆盖**
   - 最大/最小值
   - 溢出条件
   - 零操作数

### 自检测试程序

```asm
@ 自检测试模板
@ 每个测试通过后将结果写入特定内存地址

test_add:
    MOV R0, #100
    MOV R1, #50
    ADD R2, R0, R1
    CMP R2, #150
    BNE fail
    MOV R10, #1         @ 测试1通过
    STR R10, [R11]      @ 记录结果
    
test_sub:
    MOV R0, #100
    MOV R1, #50
    SUB R2, R0, R1
    CMP R2, #50
    BNE fail
    MOV R10, #2         @ 测试2通过
    ADD R11, R11, #4
    STR R10, [R11]
    
@ ... 更多测试 ...

pass:
    MOV R0, #0xFFFF
    STR R0, [R12]       @ 通过标志
    B end
    
fail:
    MOV R0, #0xDEAD
    STR R0, [R12]       @ 失败标志
    
end:
    B end               @ 停机
```

---

## 📝 代码实现

详见 `tb/tb_arm_core.v`

---

## ✅ 检查点

- [ ] 所有基本指令通过测试
- [ ] 数据冒险测试通过
- [ ] 控制冒险测试通过
- [ ] 边界条件测试通过
- [ ] 功能覆盖率 > 90%

---

## 🔗 下一步

完成本实验后，继续 **Lab 10: 综合与时序分析**。

# Lab 10: ç»¼åˆä¸æ—¶åºåˆ†æ

## ğŸ“‹ å®éªŒæ¦‚è¿°

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **å®éªŒåç§°** | FPGA ç»¼åˆä¸æ—¶åºæ”¶æ•› |
| **é¢„è®¡æ—¶é•¿** | 8-10 å°æ—¶ |
| **éš¾åº¦ç­‰çº§** | â­â­â­â­â­ |
| **å‰ç½®å®éªŒ** | Lab 1-9 |

## ğŸ¯ å®éªŒç›®æ ‡

1. åœ¨ Vivado ä¸­å®Œæˆç»¼åˆ
2. ç†è§£æ—¶åºçº¦æŸ (XDC)
3. æ—¶åºåˆ†æä¸ä¼˜åŒ–
4. èµ„æºåˆ©ç”¨åˆ†æ

---

## ğŸ“š ç†è®ºèƒŒæ™¯

### Vivado è®¾è®¡æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vivado Design Flow                         â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  RTL     â”‚â”€â”€â”€â–¶â”‚ Synthesisâ”‚â”€â”€â”€â–¶â”‚  Impl    â”‚â”€â”€â”€â–¶â”‚ Bitstreamâ”‚ â”‚
â”‚  â”‚  Design  â”‚    â”‚          â”‚    â”‚(P&R)     â”‚    â”‚ Generate â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚               â”‚               â”‚               â”‚         â”‚
â”‚       â–¼               â–¼               â–¼               â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Simulationâ”‚    â”‚ Report   â”‚    â”‚ Timing   â”‚    â”‚ Program  â”‚ â”‚
â”‚  â”‚          â”‚    â”‚ (Area)   â”‚    â”‚ Analysis â”‚    â”‚ FPGA     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ—¶åºçº¦æŸ (XDC)

```tcl
# æ—¶é’Ÿå®šä¹‰
create_clock -period 10.000 -name clk [get_ports clk]

# è¾“å…¥å»¶è¿Ÿ
set_input_delay -clock clk -max 2.0 [get_ports {data_in[*]}]
set_input_delay -clock clk -min 0.5 [get_ports {data_in[*]}]

# è¾“å‡ºå»¶è¿Ÿ
set_output_delay -clock clk -max 2.0 [get_ports {data_out[*]}]
set_output_delay -clock clk -min 0.5 [get_ports {data_out[*]}]

# å‡è·¯å¾„
set_false_path -from [get_ports rst_n]

# å¤šå‘¨æœŸè·¯å¾„
set_multicycle_path -setup 2 -from [get_cells */mul_reg*] -to [get_cells */result_reg*]
```

### æ—¶åºè·¯å¾„åˆ†æ

```
                        Setup Time Check
                        
Launch Edge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Capture Edge
                                            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Source   â”‚â”€â”€â”€â”€â”€â–¶â”‚ Comb      â”‚â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–¶â”‚   Dest    â”‚
    â”‚   FF      â”‚      â”‚ Logic     â”‚       â”‚    â”‚    FF     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚              â”‚          â”‚
         â”‚                  â”‚              â”‚          â”‚
         â”‚â—€â”€â”€â”€ tclk2q â”€â”€â”€â”€â–¶â”‚â—€â”€ tlogic â”€â”€â”€â–¶â”‚â—€â”€ tsu â”€â”€â–¶â”‚
         â”‚                  â”‚              â”‚          â”‚
    â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
                         Tclock (Period)
    
    Slack = Tclock - tclk2q - tlogic - tsu - tuncertainty
```

### å…³é”®è·¯å¾„ä¼˜åŒ–ç­–ç•¥

1. **æµæ°´çº¿åŒ–**
```verilog
// Before: é•¿ç»„åˆè·¯å¾„
assign result = (a + b) * c + d;

// After: æ’å…¥æµæ°´çº¿å¯„å­˜å™¨
always @(posedge clk) begin
    stage1 <= a + b;
    stage2 <= stage1 * c;
    result <= stage2 + d;
end
```

2. **é€»è¾‘é‡å®šæ—¶**
```verilog
// Before: å¯„å­˜å™¨åˆ†å¸ƒä¸å‡
// A â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ long_logic â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ B â”€â”€â”€â–¶ short â”€â”€â”€â–¶ C

// After: å¯„å­˜å™¨é‡åˆ†å¸ƒ
// A â”€â”€â”€â”€â”€â–¶ logic1 â”€â”€â”€â”€â”€â–¶ B' â”€â”€â”€â”€â”€â–¶ logic2 â”€â”€â”€â”€â”€â–¶ C
```

3. **èµ„æºå¤åˆ¶**
```verilog
// Before: æ‰‡å‡ºè¿‡å¤§
wire shared_signal;
assign out1 = shared_signal & ...;
assign out2 = shared_signal & ...;
// ... many more

// After: å¤åˆ¶ä¿¡å·æº
wire shared_signal_1, shared_signal_2;
// åˆ†ç»„ä½¿ç”¨
```

---

## ğŸ“ XDC çº¦æŸæ–‡ä»¶

è¯¦è§ `constraints/timing.xdc`

---

## âœ… æ£€æŸ¥ç‚¹

- [ ] ç»¼åˆæ— é”™è¯¯
- [ ] æ—¶åºæ»¡è¶³çº¦æŸ
- [ ] WNS (Worst Negative Slack) â‰¥ 0
- [ ] èµ„æºåˆ©ç”¨åˆç† (< 80%)
- [ ] åŠŸè€—åˆ†æå®Œæˆ

---

## ğŸ“ è¯¾ç¨‹æ€»ç»“

æ­å–œå®Œæˆ ARM Cortex-A9 HDL ä»¿çœŸå®éªŒè¯¾ç¨‹ï¼

é€šè¿‡æœ¬è¯¾ç¨‹ï¼Œæ‚¨åº”è¯¥æŒæ¡äº†ï¼š
1. ARM å¤„ç†å™¨æ¶æ„åŸºç¡€
2. 5 é˜¶æ®µæµæ°´çº¿è®¾è®¡
3. å†’é™©æ£€æµ‹ä¸æ•°æ®å‰é€’
4. ç¼“å­˜ç³»ç»Ÿè®¾è®¡
5. AXI æ€»çº¿æ¥å£
6. åŠŸèƒ½éªŒè¯æ–¹æ³•
7. FPGA ç»¼åˆä¸æ—¶åºåˆ†æ
